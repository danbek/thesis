\chapter{Subarray Characterization}\label{c:det-array}

The first 251-detector subarray has not yet been characterized as thoroughly as the prototype detectors.
In particular, only seven good have been characterized.
The reason for this is that the saturation power of the detectors is xxx time higher than expected, which means that only some detectors be driven normal, and only at bath temperatures very close to $T_c$.
In particular, none of the detector can be driven normal at the operating bath temperature for the array of 1100~mK.
This means that we do not have \IV\ curves for any detectors at operating conditions, which limits the characterization than can be performed.

Seven detectors used in taking images have working heaters and no other problems.
These heaters allow us to take full \IV\ curves at all bath temperatures, allowing estimate of the detector thermal conductance $G$.
The heaters also allow a direct measurement of detector responsivity and time constants, and thus allow a measurement of detector noise referred to optical power incident on the detector.
This chapter describes these measurements on these seven detectors, as well as measurements of shunt resistor an inductances for all detectors.

Note that this lack of detector characterization does not prevent the array from working.
It merely limits our understanding of the behavior of the detectors.
A more detailed characterization of more detectors will be carried out prior to fabrication of any additional arrays.

\section{Shunt Resistance Measurements}

Our shunt resistors are located on interface chips that contain both shunt resistors and Nyquist inductors.
The specific chips used were extra chips leftover from the ABS\cite{kusaka_modulation_2013} project.
The design resistance of the shunts was 180~\uOhm, and the design inductance was 609~nH\footnote{John Appel, personal communication}.
Each chips contains 32 shunt resistors and 32 inductors.

To measure $R_{sh}$ and $L$ for these chips I took noise measurements using zero detector bias current at two different bath temperature: 980~mK and 1160~mK.
At these bath temperatures and at zero detector bias the detectors are superconducting, so that measured noise is due to the shunt resistor, and parasitic resistance, and SQUID noise in the multiplexed readout system itself.
Data was collected at 3030.3~Hz, and 20 data acquisitions lasting 33 seconds were taken at each bath temperature.

A power spectrum was estimated for each detector for each data acquisition using \MATLAB's \texttt{pwelch} function, using a \FFT\ size of $2^{12}$.
Each resulting power spectrum was fit to a function of the form
\begin{eqnarray}\label{eqn:scnoise-fit}
	\frac{4 k_B T_b}{R_{sh}} \frac{1}{1 + (2 \pi f (L/R_{sh}))^2} + SQ,
\end{eqnarray}
where $k_B$ is Boltzmann's constant, $T_b$ is the bath temperature for the measurement, and $f$ is the frequency.
The shunt resistance $R_{sh}$, inductance $L$, and readout chain white noise level $SQ$ are the values extracted from the fit.

\figref{fig:rsh-l-plots} shows histogram plots of the resulting \Rsh\ and $L$ values.
\Rsh\ has a mean of 149~\uOhm\ with standard deviation 6~\uOhm.
The meassured value for \Rsh\ also includes any parasitic resistance in the circuit, but no evidence for significant parasitic resistance has ever been seen, so this parasitic resistance is assumed to be zero.

The measured value for $L$ includes the Nyquist inductance on the interface chip, the input inductance of the first-stage \SQUID\ of the multiplexed readout system, as well as any parasitic inductance in the circuit.
Using this measurement it is not possible to extract the inductance of the Nyqust inductor itself, but this is not a problem because the total inductance is the relevant  quantity for understanding the behavior of the detector and it's circuit.

$L$ has a mean of 574~nH with a standard deviation of 87~nH.
However, this mean includes two sets of clear outliers: all values for multiplexing row 4 are clustered around 200~nH, and all values for multiplexing row 25 are clustered around 440~nH.
The reason for these low inductances is not understood.
Excluding rows 4 and 25,  $L$ has a mean of 593~nH with a standard deviation of 44~nH.

The outlier $L$ values are more clearly visible in the lower left plot in \figref{fig:rsh-l-plots}, which also shows a small correlation between \Rsh\ and $L$.
It is not known whether this correlation is a real physical effect or an artifact of the measurement process.

\begin{figure*}
\includegraphics{drawings/ch8-rsh-l-plots.pdf}
\caption{Plots summarizing results of measurements of shunts and Nyqust inductors.
\textbf{Upper Left} Histogram of shunt resistance \Rsh.
\textbf{Upper Right} Histogram of total inductance in circuit, which includes the interface chip Nyquist inductor, the inductance of the SQ1 input coil, and any parasitic inductance.
\textbf{Lower Left} Scatterplot showing all measured Rsh and L values. A correlation is apparent, the reason for which is not understood.
\textbf{Lower Right} Plot showing current noise power spectrum extracted from a single data acquisition for \RCm{20}{6}, along with predicted power spectrum based on best fit to \eqnref{eqn:scnoise-fit} across all data acquisitions. The best fit values are \Rsh\ = 153 \uOhm, $L$ = 622 nH, and \SQUID\ white noise level of 1.2e-10~ A$/ \sqrt{\mbox{Hz}}$.}
\label{fig:rsh-l-plots}
\end{figure*}

\section{Measurement of Heater Resistors}

Only 23 of the 251 detectors have heaters wired up.
Of these 23, there are nine detectors which show no response to applied heater power.
Five of these nine are on the cut list (xxx see ch xxx), so this is not surprising.
But four detectors can be biased into the transition and work well, but show no response to applied heater power (\RC{4}{7}, \RC{5}{7}, \RC{6}{6}, \RC{7}{6}).
The reasons for these detectors not showing a response to heater power are not fully understood.
This leaves 14 working detectors that also show a response to applied heater power.
However, a short between one of the \TES\ bias lines and the heater bias line means that ramping the current bias for some of the \TES\ detectors also ramps the heater bias.
This means that for seven of the 14 working detectors that show a response to applied heate power, interpreting \IV\ curves is difficult because a different amount of heater power is applied at each detector bias value.
This means that for these seven detectors it is not possible to measure $G$ or to calibrate the power being applied by the resistors.

This leaves seven detectors with heaters for which \IV\ curves can be taken, and $G$ measured.
The heaters on these seven detectors can be used to directly measure the detector responsivity, noise referred to input optical power, time constants and thermal conductance $G$.
But all of these measurements require knowing the resistance of the heaters.
This section describes my measurement of the heater resistances.

To measure the heater resistances, I took a set of \IV\ curves at constant bath temperature.
For each \IV\ curve I applied a different heater current, so that a different amount of heater power was applied to the \TES\ for each curve.
The total amount of power flowing through the \TES\ thermal conductance $G$ is then given by
\begin{equation}\label{eqn:tes-ptot}
P_{tot} = K(T^n - T_b^n) = P_{opt} + P_{htr} + I^2 R(T,I),
\end{equation}
where $T$ is the temperature of the \TES, $R$ is the resistance of the \TES, and $I$ is the current flowing through the \TES.
I make the assumption that at the start of the superconducting transition $\beta_I = 0$, i.e.\ the resistance of the \TES\ depends only on the \TES\ temperature, and not on the current through the \TES.
This implies that each time the \TES\ reaches, e.g.\ $0.99R_n$, the temperature of the \TES\ is the same, and therefore $P_{tot}$ will be the same.
A relationship of the following form must therefore hold:
\begin{equation}\label{eqn:rhtr-fit}
P_{J} = (P_{tot} - P_{opt}) - I_{htr}^2 R_{htr}.
\end{equation}
A fit can be made to this function, with the quantities $R_{htr}$ and $P_{x} \equiv P_{tot} - P_{opt}$ to be solved for.

\figref{fig:heater-r-plots} explains this idea further by a series of plots.
The upper left plot shows the \TES\ \IV\ curves.
The upper right plot shows the same data, but transformed into \TES\ Joule power and \TES\ resistance.
As applied heater current decreases, the Joule power at the start of the transition decreases.
In the lower left, the Joule power at $0.99R_{n}$ is plotted vs applied heater current.
A fit to \eqnref{eqn:rhtr-fit} is also plotted.
Finally, the lower right plot show the $R$ vs $P_J$ plots after the heater power has been added to each curve.
This plots shows that the powers are equalized very high in the transition, where the assumption of Joule power dependent only on \TES\ resistance holds.
It also shows that this assumption breaks down deeper in the transition.

\begin{figure*}
\includegraphics{drawings/ch8-heater-r-plots.pdf}
\caption{Plots heater measurements, for the case of \RCm{29}{1}.
\textbf{Upper Left} \IV\ curves. The \IV\ curves should turn completely vertial when the detector becomes fully superconducting at zero voltage, but these curves shown a non-infinite slope. The reason for this is that the readout system as configured for these \IV\ curves was unable keep up with the rapid change of current in the superconducting branch.
\textbf{Upper Right} Same data as in upper left plot, but represented in terms of \TES\ Joule power and resistance. As the bias current for the heaters is increased, the curves shift to the left.
\textbf{Lower Left} Measured $P_{J}$ vs heater current at $0.99R_n$, as well as fit to \eqnref{eqn:rhtr-fit}.
\textbf{Lower Right} Same plot as upper right, but the heater power based on $R_{htr} = 23.6$~\Ohm has been added to each curve.}
\label{fig:heater-r-plots}
\end{figure*}

\tableref{tab:all-det-props} lists all measured heater resistors.
The seven heaters for columns 0 and 1 have a mean of 23.8~\Ohm\ with a standard deviation of 0.26~\Ohm.

It is worth noting that determining the values of $R_{htr}$ requires knowing the current through the heaters.
But because $R_{htr}$ is determined through the power disspiated in the resistor, an incorrect assumption about will lead to a an incorrect value of $R_{htr}$ which leaves $I_{htr}^2 R_{htr}$ unchanged.
So whenever the value $R_{htr}$ is used to calculated a power, the power value will be correct even in the face of an incorrect assumption about the current through the heater.

\begin{table*}[t]
\centering
\caption{Measured Detector Properties. Uncertainties are 95 \% confidence intervals.}
\label{tab:all-det-props}
\begin{tabular}{l l l l l}
\toprule
Detector &  $R_{htr}$ (\Ohm) & $G$ (nW/K) & $n$ & $T_c$ (mK) \\
\midrule
\RCm{29}{1} & 23.6 & 7.63 $\pm$ 0.08 & 3.52 $\pm$ 0.10 & 1209.4 $\pm$ 0.6 \\
\RCm{30}{1} & 23.5 & 7.67 $\pm$ 0.07 & 3.54 $\pm$ 0.09 & 1213.9 $\pm$ 0.6 \\
\RCm{31}{1} & 24.3 & 7.78 $\pm$ 0.09 & 3.64 $\pm$ 0.11 & 1214.7 $\pm$ 0.7 \\
\RCm{32}{1} & 23.9 & 7.01 $\pm$ 0.44 & 3.18 $\pm$ 0.61 & 1211.6 $\pm$ 3.8 \\
\RCm{29}{2} & 23.8 & 7.70 $\pm$ 0.09 & 3.62 $\pm$ 0.12 & 1213.7 $\pm$ 0.7 \\
\RCm{31}{2} & 23.6 & 7.32 $\pm$ 0.17 & 3.45 $\pm$ 0.22 & 1211.3 $\pm$ 1.4 \\
\RCm{32}{2} & 23.8 & 7.50 $\pm$ 0.28 & 3.74 $\pm$ 0.36 & 1215.6 $\pm$ 2.3 \\
\bottomrule
\end{tabular}
\end{table*}

\section{Measurement of \TES\ $G$}

With knowledge of the heater resistances, \IV\ curves can be taken over a wide range of bath temperatures, which enables a measurement of the \TES\ thermal conductance $G$.
Similarly to \sectionref{xxx}, I took \IV\ curves at bath temperatures ranging from xxx mK -- xxx mK, while adjusting the applied heater power so that each \IV\ curve had a clear normal branch.
I again used the assumption that high in the transition the \TES\ resistance depends on only the \TES\ temperature, so that the Joule power $P_J$ dissipated in the \TES\ at $0.99R_n$ depends only on the bath temperature $T_b$ and the applied heater power $P_{htr} = I_{htr}^2 R_{htr}$. A fit can then be made to \eqnref{eqn:tes-ptot} in the form
\begin{equation}\label{eqn:g-fit}
P_{htr} + P_J + P_{opt}= \frac{G T_c}{n}\left(1 - \left(\frac{T_b}{T_c}\right)^n\right).
\end{equation}
The parameters to be fit to are $G$, $T_c$, and $n$.

A problem arises because the data described in this section were taken when the cryostat was open, so that $P_{opt}$ was non-zero, with an unknown value.
Because $P_{opt}$ is a simple additive constant, it is not possible to fit for this value unless another constraint (such as the value of $T_c$) is known.
However, the value of $P_{opt}$ can be estimated in two different ways. 
First, the predicted optical load of 165~pW from \sectionref{xxx} can be used.
Second, optical load on the prototype detectors was estimated to be in the range 135~pW--165~pW (xxx ref some section).
In this analysis I assumed $P_{opt} = 150 pW$, while also showing how different assumptions change the values of  $G$, $T_c$, and $n$.

\tableref{tab:all-det-props} lists the resulting values for $G$, $T_c$ adn $n$.
\figref{fig:heater-g-plots} contains plots summarizing and explaining this data.
The uncertainties in $G$, $T_c$ and $n$ introduced by the unknown value of $P_{opt}$ are different.
$G$'s uncertainty from $P_{opt}$ is no lager than the statistical uncertainty due to the fit, while $T_c$'s uncertainity from $P_{opt}$ is larger than the statistical uncertainty.
Both of these uncertainties should be taken into account when predicting measurement of detector noise.
$n$ shows no apparent trend with $P_{opt}$.

\begin{figure*}
\includegraphics{drawings/ch8-g-plots.pdf}
\caption{Plots summarizing results of $G$, $T_c$ and $n$ measurements for seven detectors with good heaters.
All error bars are 95 \% confidence intervals for statisical error; any systematic error is not included.
\textbf{Upper Left} Plot showing $P_{sat}$ vs $T_b$ for \RCm{31}{2}, assuming $P_{opt} = 150$~pW.
The red line shows the best fit to \eqnref{eqn:g-fit}.
The data covers 25 temperatures from 995~mK--1160~mK, and 11 different heater biases.
\textbf{Upper Right} Scatter plot showing correlation between $G$ and $n$, as well as error bars for both.
There is no apparent correlation between $G$ and $T_c$ or $n$ and $T_c$.
\textbf{Lower Left} Plot showing variation of $G$ for \RCm{31}{2} vs assumed value of $P_{opt}$.
The statistical uncertainty in $G$ for this detector is approximately the same as the systematic uncertainty that results from the estimation of $P_{opt}$.
\textbf{Lower Right} Plot showing variation of $T_c$ for \RCm{31}{2} vs assumed value of $P_{opt}$.
In this case the systematic uncertainty is larger than the statistical uncertainity.
The value of $n$ shows no trend with $P_{opt}$.
} 
\label{fig:heater-g-plots}
\end{figure*}

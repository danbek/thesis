\chapter{TES Bolometer Theory}\label{c:tes}

This chapter summarizes the \TES\ theory used in this thesis.
I start by describing the \TES electrical and thermal circuits, defining relevant parameters, and stating the linearized \TES\ equations.
For reference I then summarize the import consequences of these equations, including expressions for detector responsivity, detector response to step functions in applied power and bias current, and detector noise.
I do not derive most of these results, because excellent references for these results are available\cite{irwin2005transition}.

I discuss the derivation of two results in detail.
First, I describe a new approach for measuring the natural detector time constant $\tau$ by extrapolating several measurements of the effective detector time constant $\tau_{eff}$ high in the transition. 
Second, I give an expression for the time-domain response to a step function in applied detector bias current.

\section{\TES\ Electrical And Thermal Circuits}

\figref{fig:elec-thermal-circuit} shows the electrical and thermal circuits for a \TES\ bolometer.
The bolometer is voltage-biased by passing a bias current $I_{bias}$ through a shunt resistor \Rsh\ which has a much lower resistance than the normal-state resistance $R_n$ of the \TES.
The current through the \TES\ is inductively coupled into a \SQUID\ for readout.
The inductance $L$ in the diagram represents the sum of the input inductance of the \SQUID, a Nyquist Inductor, and any parasitic inductance present in the circuit.

The \TES\ itself is represented by a variable resistance $R$, which depends on both the current through the \TES\ and the temperature of the \TES.
The \TES\ is thermally connected heat capacity $C$ which is weakly linked to a temperature bath $T_b$ through a thermal conductance $G$.
Optical power falls onto the heat capacity, causing the temperature $T$ of the heat capacity and the \TES\ to rise above $T_b$.
Joule power dissipated in the \TES\ also contributes to this temperature rise, as does power dissipated in any heater resistor present on the \TES\footnote{As described in \sectionref{xxx}, 31~detectors have heater resistors.}.

Because the resistance of the \TES\ depends on the temperature of the \TES, and the temperature of the \TES depends on the resistance of the \TES through Joule heating, the electrical and thermal behavior of the \TES are coupled.
This coupling acts as feedback, termed ``negative electrothermal feedback'', first described in the context of \TES\ detectors by Irwin\cite{irwin1995application}.
That this coupling acts as negative feedback can be seen as follows.
As the optical power falling on the \TES\ increases, the temperature of the \TES\ increases, which causes the resistance of the \TES\ to increase as well.
Because the \TES\ is voltage-biased, the Joule heating is inversely proportional to the resistance, so the Joule heating decreases, which causes the temperature of the \TES\ to decrease, opposing the effect of the increased optical power.

\begin{figure*}
%\input{\here/elec-thermal-circuit}
\caption{Electrical and thermal \TES\ circuits.
\textbf{Left} Electrical \TES\ circuit.
The \TES\ is biased by a stiff current $I_{bias}$ shunted across a resistor $R_{sh}$ that is much smaller than the normal-state resistance of the \TES.
The \TES\ is represented by a variable resistance $R$, and $R_{par}$ represents any parasitic resistance in the circuit.
The current through the \TES\ is inductively coupled into a \SQUID\ for readout.
The inductance $L$ represents the sum of the input inductance of the \SQUID, a Nyquist Inductor, and any parasitic inductance present in the circuit.
\textbf{Middle} Thevenin-equivalent \TES\ circuit, used in analysis of the \TES\ and derivation of the linearized electrical and thermal equations for the \TES.
\textbf{Right} Thermal \TES\ circuit. The \TES\ is thermally sunk to a heat capacity $C$ which absorbs optical power. The heat capacity $C$ is connected to a heat bath $T_b$ by a weak thermal link $G$, so that its temperature is elevated above $T_b$ to $T$.}
\label{fig:elec-thermal-circuit}
\end{figure*}

\section{Linearized Electrical and Thermal Circuits}

In the limit of small changes in \TES\ current and temperature, the resistance of te \TES\ can be expressed as
\begin{equation}
R(T_0+\delta T,I_0+\delta I) = R_0 + \alpha \frac{R_0}{T_0} \delta T + %
									 \beta_I \frac{R_0}{I_0} \delta I.
\end{equation}
The power flowing through the thermal link $G$ is assumed to follow a power law of the form
\begin{eqnarray}
P_{bath} = K(T^n - T^n_{bath}),
\end{eqnarray}
which can also be written in the form
\begin{eqnarray}
P_{bath} = \frac{GT}{n}\left(1 - \left(\frac{T_{bath}}{T}\right)^2\right),
\end{eqnarray}
where
\begin{equation}
G \equiv \frac{d P_{bath}}{dT} = K n T^{n-1}.
\end{equation}

With these definitions it can be shown\cite{irwin2005transition} that the behavior of the \TES\ is described by a pair of coupled first-order differential equations:
\begin{equation}
\frac{d}{\mathop{dt}} \begin{pmatrix} \delta I \\ \delta T \end{pmatrix}
	= - \mathcal{M} \begin{pmatrix}	\delta I \\	\delta T \end{pmatrix}
      + \begin{pmatrix} \delta V / L \\ \delta P /C \end{pmatrix},
\end{equation}
where the matrix $\mathcal{M}$ is
\begin{equation}
% For spacing see http://tex.stackexchange.com/questions/14071/how-can-i-increase-the-line-spacing-in-a-matrix
\mathcal{M} = \begin{pmatrix}
		\frac{1}{\tau_{el}} & \frac{\Loop G}{I_0 L} \\[0.75em] 
		-\frac{I_0 R_0(2 + \beta_I)}{C} & \frac{1}{\tau_I}
    \end{pmatrix}.
\end{equation}
\tableref{tab:tes-theory-summary} describes all symbols use in these equations and the rest of the chapter.

These coupled equations can be solved under different initial conditions and applied forces $\delta V$ and $\delta P$.
Discussion of three cases follows.

\textbf{\TES\ Power-to-Current Responsivity}
Driving the \TES\ with a sinusoidal $\delta P$ term, holding detector bias constant, leads to the following expression for the detector power-to-current responsivity:
\begin{equation}\label{eqn:si-full}
s_I(\omega) = 
- \frac{ \frac{1}{V0} \frac{1}{\gamma} \frac{\Loop}{\Loop + 1} }
       { 1 + j \omega \left( \tau_{eff} - \frac{1}{\gamma}\frac{\Loop}{\Loop + 1} \frac{L}{R_0}\right) - \omega^2 \frac{L}{R_0}\frac{\tau_{eff}}{1 + \beta_I + R_L / R_0}},
\end{equation}
\begin{equation}
\gamma \equiv 1 + \frac{\beta_I}{1+\Loop} - \frac{\Loop - 1}{\Loop + 1}\frac{R_L}{R_0}.
\end{equation}
While imposing, these expressions are much simpler in the limit which generally hold for operating \TES\ detectors: strong voltage bias ($R_L \ll R_0$), and $\tau \ll L/R$. 
In this limit the power-to-current responsivity becomes
\begin{equation}
s_I(\omega) = -\frac{1}{V_0} \frac{\Loop}{1+\beta_I + \Loop} \frac{1}{1 + j \omega \frac{\tau}{1 +\Loop/(1+\beta_I)}}
\end{equation}
The detector response time is given by the natural detector time constant $\tau$, sped up by a factor of $1 + \Loop(1+\beta_I)$; for $\beta_I \ll 1$, this factor is typical of negative feedback, and justifies calling \Loop\ the ``loop gain'' of the detector.
In the further limit of strong electrothermal feedback ($\Loop \gg 1, \gg \beta_I$), the \DC responsivity is simply the inverse of the voltage bias.
This represents that fact that under strong electrothermal an increase in applied optical power is exactly canceled by a decrease in detector Joule heating, so that the \TES\ temperature remains unchanged.

\textbf{\TES\ Response to Step Function in Power}
Heater resistors can be used to apply step function in power to the detectors.
Solving the equations under the conditions
\begin{equation}
\begin{pmatrix} \delta I(0) \\ \delta T(0) \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}
\end{equation}
with constant driving force starting at time zero of
\begin{equation}
\begin{pmatrix} 0 \\ \delta P_{htr} / C \end{pmatrix}
\end{equation}
leads to the following expression for the \TES\ current as a function of time:
\begin{equation}
xxx
\end{equation}
xxx commentary

\textbf{\TES\ Response to Step Function in Bias Current}
To derive the behavior of the \TES\ after a step function in applied bias, we solve the equations under the conditions
\begin{equation}
\begin{pmatrix} \delta I(0) \\ \delta T(0) \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}
\end{equation}
with constant driving force starting at time zero of
\begin{equation}
\begin{pmatrix} \delta I_{bias} R_{sh} / L \\ 0 \end{pmatrix}
\end{equation}
Solving this system leads to the following expression for the \TES\ current as a function of time:
\begin{equation}\label{eqn:bias-step-resp}
\delta I (t)
   = - \frac{\delta I_{bias} R_{sh}}{R_0} 
       \frac{(\Loop - 1)
             \left(1 - \frac{\tau_{eff} - \tau_I}{\tau_{eff} - \tau_{el}} e^{-t/\tau_{eff}}
                 	       + \frac{\tau_{el} - \tau_I}{\tau_{eff} - \tau_{el}} e^{-t/\tau_{el}} \right)}
            {1 + \beta_I + R_L/R_0 + \Loop(1 - R_L/R_0)}
       .
\end{equation}
This expression is complicated, but the behavior can be understood as follows.
Immediately after an increase in bias current the current flowing through the \TES\ begins to increase, with a time constant of $\tau_{el}$.
As the current through the \TES increases, the Joule power in the \TES\ will also begin to increase, which warms the \TES.
This warming increases the resistance of the \TES.
Because the \TES is voltage-biased, this reduces Joule power in the \TES, which tends to cool the detector as well as reduce current through the detector.
This negative electrothermal feedback effect occurs with a time constant of $\tau_{eff}$.
Whether the final current through the \TES\ is higher or lower than the original currents depends on the loop gain.
For $\Loop < 1$ the current increases, for $\Loop > 1$ it decreases and for $\Loop = 0$ the current through the \TES\ remains unchanged.

\eqnref{eqn:bias-step-resp} depends on \Loop\ and $\beta_I$ in a complicated way through $\tau_{eff}$, $\tau_I$, $\tau_{el}$, and the prefactor.
Nevertheless, if the response of a \TES\ to a bias step can be measured with sufficient bandwidth to track the initial fast electrical response, bias steps can be used to measure \Loop and $\beta_I$ by performing non-linear parameter fitting to \eqnref{eqn:bias-step-resp}.
Measurements of \Loop\ and $\beta_I$ using this technique are described in \sectionref{xxx}.

When the \TES\ is superconducting, \eqnref{eqn:bias-step-resp} takes on a much simpler form.
Setting $R_0 = \Loop = \beta_I = 0$, the result is
\begin{equation}\label{eqn:bias-step-resp-sc}
\delta I(t)
   = - \frac{\delta I_{bias} R_{sh}}{R_{L}} 
       \left(1 - e^{-t/(L/R_L)} \right).
\end{equation}
Similarly, when the detector is fully normal, so that $\Loop = \beta_I = $, \eqnref{eqn:bias-step-resp} becomes
\begin{equation}\label{eqn:bias-step-resp-normal}
\delta I(t)
   = - \frac{\delta I_{bias} R_{sh}}{R_n + R_{L}} 
       \left(1 - e^{-t/(L/(R_n+R_L))} \right).
\end{equation}
The \TES\ response to bias steps in the superconducting and normal states can thus be used as measurements of $L$ and $R_n$.

\begin{table*}[t]
\centering
\caption{Symbols and parameters used in describing behavior of \TES\ circuits.}
\label{tab:tes-theory-summary}
\begin{tabular}{l l}
\toprule
Symbol &  Explanation \\
\midrule
$I_{bias}$ & Current applied across shunt to bias \TES. \\
$R$ & \TES\ resistance (depends on temperature \& current) \\
$R_n$ & \TES\ normal-state resistance \\
$R_{sh}$ & Shunt resistance \\
$R_{par}$ & Represents any parasitic resitance in \TES\ circuit \\
$R_L \equiv R_{sh} + R_{par}$ & Load resistance used in analysis of \TES\ circuit \\
$T$ & \TES\ temperature \\
$T_b$ & Thermal bath temperature \\
$I_0, R_0$ & \TES\ current and resistance at bias point \\
$P_{bath} = K(T^n - T_{bath}^n)$ & Total heat flow from \TES\ island to heat bath \\
$P_{opt}$ & Optical power falling onto \TES\ heat capacity \\
$P_{htr}$ & Power applied to \TES\ by heater resistor \\
$P_{J}$ & Joule power dissipated by \TES\ \\
$C$ & Heat capacity of \TES\ island \\
$G \equiv \frac{d P_{bath}}{d T} = K n T^{n-1}$ & Weak-link differential thermal conductance \\
$\tau \equiv \frac{C}{G}$ & \TES\ natural time constant \\
$\tau_{el} \equiv \frac{L}{R_L + R_0(1 + \beta_I)}$ & \TES\ electrical time constant \\
$\tau_I \equiv \frac{\tau}{1-\Loop}$ & \TES\ constant-current time constant \\
$\tau_{eff} \equiv \frac{\tau}{1 + \frac{1 - R_L / R_0}{1 + \beta_I + R_L / R_0}\Loop}$ & \TES\ effective time constant \\
$\alpha \equiv \frac{T_0}{R_0} \frac{\partial R}{\partial T}$ & \\
$\beta_I \equiv \frac{I_0}{R_0} \frac{\partial R}{\partial I}$ & \\
$\Loop \equiv \frac{I_0^2 R_0 \alpha}{G T_0}$ & Loop gain \\
$\delta V = \delta I_{bias} R_{sh}$ & Change in bias applied to \TES\ \\
$\delta P$ & Change in power (optical or heater) falling on \TES\ \\
\bottomrule
\end{tabular}
\end{table*}

\section{Measurement of Natural Time Constant}

Near the top of the superconducting transition, $\Loop < 1$, so that $\tau_{eff} > 0.5 \tau$.
Detectors circuits are always design so that $\tau \gg L/_n$, so that \eqnref{eqn:si-full} simplifies to
\begin{equation}
s_I(\omega) = - \frac{1}{V_0 \gamma}\frac{\Loop}{\Loop + 1}
                       \left(1 + j \omega \tau_{eff}\right)^{-1}.
\end{equation} \label{eqn:htr-step-resp-high}
This implies that the time-domain response to step in applied power, for example from a heater, is
\begin{equation}
\delta I(t) = - \frac{\delta P}{V_0 \gamma}\frac{\Loop}{\Loop + 1}
                (1 - e^{-t/\tau_{eff}}).
\end{equation}
As the fully normal state is approached, $\tau_{eff}$ approaches $\tau$, so that measuring the time constant very high in the transition will give a measurement of $\tau$.
However, the power-to-current  responsivity becomes smaller and smaller high in the transition, so that this measurement becomes more and more difficult.
If we knew \Loop\ and $\beta_I$ high in the transition we could extract $\tau$ from $\tau_{eff}$, but we do not always know these values.

However, it turns out that an expression can be obtained linking $\tau$ and $\tau_{eff}$ that holds independent of location in the transition, as long as the assumption $\tau_{eff} \gg L/R_0$ holds.
The \DC\ response to a step in applied power $\delta $ is given by
\begin{equation}
\delta I = \frac{\delta P}{I R}\frac{\Loop}{1 + \beta_I + R_L/R_0 + (1 - R_L / R_0)\Loop}.
\end{equation}
This equation can solved for \Loop, and then subsituted into the expression for $\tau_{eff}$.
This leads to
\begin{equation}\label{eqn:teff-from-tau}
\tau_{eff} = \tau - \tau \mathcal{K} I_{bias} \delta I,
\end{equation}
\begin{equation}
\mathcal{K} \equiv \frac{R_{sh}}{\delta P} \frac{R_0 - R_L}{R_0 + R_L}.
\end{equation}
Here the relation
\begin{equation}
I = I_{bias}\frac{R_{sh}}{R + R_L}
\end{equation}
has also been used.

\eqnref{eqn:teff-from-tau} holds independent of \Loop\ and $\beta_I$.
The factor $\mathcal{K}$ depends on the bias point, but high in the transition this dependence is weak, so that $\mathcal{K}$ can be treated as a constant.

To use \eqnref{eqn:teff-from-tau} to mesure $\tau$, steps in heater power are applied to the \TES\ at a set of bias points close to the normal state.
At each bias point the \DC\ change in \TES\ current $\delta I$ and $\tau_{eff}$ are measured by fitting the \TES\ response to \eqnref{eqn:htr-step-resp-high}, and the bias current $I_{bias}$ is recorded.
A non-linear curve fit can then be applied to \eqnref{eqn:teff-from-tau} to solve for $\tau$ and $\mathcal{K}$.
Alternately, $\mathcal{K}$ can be calculated if all factors feeding into it is known, and then \eqnref{eqn:teff-from-tau} can be solved directly for $\tau$.

\sectionref{xxx} Presents measurements of the $\tau$ of xxx detectors using this technique.

\section{\TES\ Bolometer Noise}

There are three sources of noise in \TES\ bolometers: Johnson noise in the \TES\ resistance, Johnson noise in the load resistor $R_L$, and thermal fluctuation noise (\TFN) across the weak thermal link $G$.
Expressions for these sources of noise are shown in \tableref{tab:tes-noise}, both in terms of current noise and in noise referred to power incident on the detector.

For typical operating conditions of \TES\ bolometers, the low-frequency noise is dominated by thermal fluctuation noise.
This can be see by taking the ratio of $S_{I_{TES}}$ to $S_{TFN}$ (ignoring factors of order unity):
\begin{equation}
\frac{S_{I_{TES}}}{S_{TFN}} = \frac{1}{\alpha \Loop} (1 + (\omega \tau)^2)
\end{equation}
At low frequencies the \TES\ resistor current noise is suppressed below \TFN\ noise by a factor of $1/\alpha \Loop$.
\TES\ detectors are always biased so that $\Loop > 1$, and values for $\alpha$ in the transition are 100--1000.
Examination of \tableref{tab:tes-noise} shows that current noise from the load resistor is lower than that from the \TES\ resistor by a factor of $(\Loop-1)^2 (R_0 / R_L) (T_0/T_L)$.
All this points to the conclusion that noise in \TES\ bolometers is dominated by \TFN\ noise.

xxx need to discuss $F(T_0, T_b)$.

xxx reference Mather for explanation of feedback suppressing johnson noise?

\begin{table*}[t]
\centering
\caption{Noise in \TES\ bolometers. To obtain noise reffered to power incident on the bolometer, divide each power spectral density by $|s_I(\omega)|^2$}
\label{tab:tes-noise}
\begin{tabular}{l l}
\toprule
Noise Source &  Current Noise \\
\midrule
\TES\ Resistor & $S_{I_{TES}} = 4 k_B T_0 I_0^2 R_0 \xi(I_0) \frac{(1 + (\omega \tau)^2) } {\Loop^2} |s_I(\omega)|^2$ \\
Load Resistor & $S_{I_{L}} = 4 k_B T_L I_0^2 R_L \frac{(1 + (\omega \tau_I)^2) (\Loop -1)^2} {\Loop^2} |s_I(\omega)|^2$ \\
Thermal Fluctuation Noise & $S_{TFN} = 4 k_B T_0^2 G F(T_0, T_b) |s_I(\omega)|^2$ \\
\bottomrule
\end{tabular}
\end{table*}

\section{\IV\ Curve Analysis}

